# @package _global_

tag: factor_pitt_obs_causal

defaults:
  - /model: pretrain_2x
  - /train: pretrain
dataset:
  datasets:
  - CRS02bHome.data.00329
  - CRS02bHome.data.00336
  - CRS02bHome.data.00339
  - CRS02bHome.data.00345
  - CRS02bHome.data.00360
  - CRS02bHome.data.00371
  - CRS02bHome.data.00402
  - CRS02bHome.data.00422
  - CRS02bHome.data.00424
  - CRS02bHome.data.00437
  # Holdout for decoding eval
  # - CRS02bHome.data.00445
  eval_datasets:
  - CRS02bHome.data.00437
  pitt_co:
    arrays:
    - CRS02b-lateral_m1
    - CRS02b-medial_m1
  max_length_ms: 4000
  max_arrays: 2
  bin_size_ms: 20
  max_channels: 96
  meta_keys:
  - MetaKey.unique
  - MetaKey.session
  - MetaKey.array
  - MetaKey.subject
model:
  task:
    tasks:
    - ModelTask.next_step_prediction
    metrics:
    - Metric.bps
  spike_embed_style: EmbedStrat.token
  neurons_per_token: 1 # 4 is slightly worse, 16 is even worse
  hidden_size: 256
  transform_space: true
  transformer:
    factorized_space_time: true
  subject_embed_strategy: EmbedStrat.token
  array_embed_strategy: EmbedStrat.none